#!/bin/sh

base=`dirname $0`/..
base=`cd $base > /dev/null && pwd`
lib=$base/lib/run
dist=$base/gen/dist
cp="$lib/*:$dist/scoreboard.jar"
log=$base/log
main=scoreboard.Main
java_cmd=java
os=`uname -s`

case $os in
Darwin)
    java_cmd=/System/Library/Frameworks/JavaVM.framework/Versions/1.6/Home/bin/java
    ;;
*)
    java_cmd=java
    ;;
esac

java -version 2> /dev/null

if [ $? -ne 0 ]; then
    echo "\`java\` not found: expected to be on path."
    exit 10
fi 

# FIX future proof this
java -version 2>&1 | head -n 1 | grep -q 1.6 || java -version 2>&1 | head -n 1 | grep -q 1.7

if [ $? -ne 0 ]; then
    echo "Incorrect java version, requires 1.6+"
    exit 20
fi

if [ ! -f "$dist/scoreboard.jar" ]; then
    echo "Could not find scoreboard.jar, try \`make dist\`"
    exit 30
fi

mkdir -p $log

java -cp "$cp" $main "$@"

